import streamlit as st
import yfinance as yf

# 1. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
st.set_page_config(page_title="AI Lotto Analytics", layout="centered")

st.title("ü§ñ AI ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏´‡∏∏‡πâ‡∏ô‡∏õ‡∏±‡∏Å‡∏´‡∏•‡∏±‡∏Å 8 ‡∏ï‡∏±‡∏ß")
st.write("‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤ Real-time ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏•‡∏Ç 64 ‡∏ä‡∏∏‡∏î")

# 2. ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏•‡∏≤‡∏î‡∏´‡∏∏‡πâ‡∏ô
market_list = {
    "‡∏ô‡∏¥‡πÄ‡∏Ñ‡∏≠‡∏¥ (‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô)": "^N225", 
    "‡∏Æ‡∏±‡πà‡∏á‡πÄ‡∏™‡πá‡∏á (‡∏Æ‡πà‡∏≠‡∏á‡∏Å‡∏á)": "^HSI", 
    "‡∏´‡∏∏‡πâ‡∏ô‡πÑ‡∏ó‡∏¢ (SET)": "^SET.BK", 
    "‡∏î‡∏≤‡∏ß‡πÇ‡∏à‡∏ô‡∏™‡πå (USA)": "^DJI",
    "‡∏´‡∏∏‡πâ‡∏ô‡∏à‡∏µ‡∏ô (SSE)": "000001.SS",
    "‡∏™‡∏¥‡∏á‡∏Ñ‡πÇ‡∏õ‡∏£‡πå (STI)": "^STI",
    "‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© (FTSE)": "^FTSE",
    "‡πÄ‡∏¢‡∏≠‡∏£‡∏°‡∏±‡∏ô (DAX)": "^GDAXI"
}
choice = st.selectbox("üéØ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏•‡∏≤‡∏î‡∏´‡∏∏‡πâ‡∏ô:", list(market_list.keys()))

# 3. ‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏±‡∏Å‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏•‡∏Ç (‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ)
st.subheader("‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏•‡∏Ç‡∏õ‡∏±‡∏Å‡∏´‡∏•‡∏±‡∏Å")
col1, col2 = st.columns(2)
with col1:
    s_tens = st.text_input("‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏¥‡∏ö (8 ‡∏ï‡∏±‡∏ß ‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≠‡∏°‡∏°‡πà‡∏≤):", "0,1,2,3,4,5,7,9")
with col2:
    s_units = st.text_input("‡∏´‡∏•‡∏±‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢ (8 ‡∏ï‡∏±‡∏ß ‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≠‡∏°‡∏°‡πà‡∏≤):", "0,1,2,4,5,6,7,9")

# 4. ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•
if st.button("üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏•‡∏Ç‡πÄ‡∏î‡πà‡∏ô"):
    try:
        # ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
        ticker = yf.Ticker(market_list[choice])
        price_data = ticker.history(period="1d")
        
        if not price_data.empty:
            price = price_data['Close'].iloc[-1]
            st.metric(label=f"üìä ‡∏£‡∏≤‡∏Ñ‡∏≤ {choice} ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î", value=f"{price:,.2f}")
        else:
            st.warning("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡πÑ‡∏î‡πâ (‡∏ï‡∏•‡∏≤‡∏î‡∏≠‡∏≤‡∏à‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà) ‡πÅ‡∏ï‡πà‡∏à‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏•‡∏Ç‡πÉ‡∏´‡πâ‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥‡∏Ñ‡∏£‡∏±‡∏ö")

        # 5. ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡πÄ‡∏•‡∏Ç
        tens = [t.strip() for t in s_tens.split(",")]
        units = [u.strip() for u in s_units.split(",")]
        res = [f"{t}{u}" for t in tens for u in units]
        
        st.success(f"‚úÖ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô! ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏Ç‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î {len(res)} ‡∏ä‡∏∏‡∏î")
        
        # 6. ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÅ‡∏ñ‡∏ß‡∏•‡∏∞ 8 ‡∏ï‡∏±‡∏ß (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô)
        st.write("üìã **‡∏ä‡∏∏‡∏î‡πÄ‡∏•‡∏Ç 64 ‡∏´‡∏≤‡∏á (‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÅ‡∏ñ‡∏ß‡∏•‡∏∞ 8 ‡∏ä‡∏∏‡∏î):**")
        
        for i in range(0, len(res), 8):
            row = res[i:i+8]
            # ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏ö‡∏ö‡πÅ‡∏ñ‡∏ß‡∏•‡∏∞ 8 ‡∏ï‡∏±‡∏ß ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏≠‡∏°‡∏°‡πà‡∏≤‡∏Ñ‡∏±‡πà‡∏ô
            st.code(", ".join(row) + ",")
            
    except Exception as e:
        st.error(f"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: {e}")
